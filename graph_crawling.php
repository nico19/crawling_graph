<?
$graf = array(
'1' => array('1' => 0, '2' => 1, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'2' => array('1' => 1, '2' => 0, '3' => 1, '4' => 1, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 1, '13' => 0, '14' => 0, '15' => 0),
'3' => array('1' => 0, '2' => 1, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 1, '12' => 1, '13' => 0, '14' => 0, '15' => 0),
'4' => array('1' => 0, '2' => 1, '3' => 0, '4' => 0, '5' => 1, '6' => 1, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'5' => array('1' => 0, '2' => 0, '3' => 0, '4' => 1, '5' => 0, '6' => 1, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'6' => array('1' => 0, '2' => 0, '3' => 0, '4' => 1, '5' => 1, '6' => 0, '7' => 1, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'7' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 1, '7' => 0, '8' => 1, '9' => 1, '10' => 1, '11' => 0, '12' => 1, '13' => 0, '14' => 1, '15' => 0),
'8' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 1, '8' => 0, '9' => 1, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'9' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 1, '8' => 1, '9' => 0, '10' => 1, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'10' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 1, '8' => 0, '9' => 1, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 1, '15' => 0),
'11' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 1, '14' => 0, '15' => 0),
'12' => array('1' => 0, '2' => 0, '3' => 1, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0),
'13' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 1, '12' => 0, '13' => 0, '14' => 1, '15' => 1),
'14' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 1, '8' => 0, '9' => 0, '10' => 1, '11' => 0, '12' => 0, '13' => 1, '14' => 0, '15' => 1),
'15' => array('1' => 0, '2' => 0, '3' => 0, '4' => 0, '5' => 0, '6' => 0, '7' => 0, '8' => 0, '9' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 1, '14' => 1, '15' => 0),
);

$city_names = array(
'1'	 => 'Армянськ',
'2'	 => 'Красноперекопськ',
'3'	 => 'Джанкой',
'4'	 => 'Роздольне',
'5'	 => 'Чорноморське',
'6'	 => 'Євпаторія',
'7'	 => 'Сімферополь',
'8'	 => 'Севастополь',
'9'	 => 'Ялта',
'10' => 'Судак',
'11' => 'Нижньогірський',
'12' => 'Гвардійське',
'13' => 'Кіровське',
'14' => 'Феодосія',
'15' => 'Керч'
);
//echo "<pre>",var_dump($city_names);

$startPoint = 5;
$endPoint = 15;
$position = $startPoint;
$path = "";
$arResult = array();

function crawling($graf, $path, $startPoint, $endPoint, $position, $city_names)
{
	if($position != $endPoint)
	{
		$path .= '_'. $position;
		$arPath = explode('_', $path);
		foreach ($graf[$position] as $key => $value) 
		{
			if($value && !in_array($key, $arPath))
			{
				//echo "point(".$key.",".$value.");<br>";
				$position = $key;

				crawling($graf, $path, $startPoint, $endPoint, $position, $city_names);
			} 
		}
	}
	else
	{
		$arPath = explode("_", $path);
		foreach ($arPath as $key => $value) {
			echo $city_names[$value]." ";
		}
		echo " ".$city_names[$endPoint]."<br>";
		//echo $path."_".$endPoint."<br>";
	}

}

crawling($graf, $path, $startPoint, $endPoint, $position, $city_names);